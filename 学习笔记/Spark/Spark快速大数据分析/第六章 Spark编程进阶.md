# Spark编程进阶

  - 两种类型的共享变量：累加器（accumulator）与广播变量（broadcast variable）。
  - 累加器用来对信息进行聚合，而广播变量用来高效分发较大的对象。
  
## 累加器

  - 累加器提供了将工作节点中的值聚合到驱动器程序中的简单语法。
  - 累加器的一个常见用途是在调试时对作业执行过程中的事件进行计数。
  - 例子：
    ```
    # 创建Accumulator[Int]并初始化为0
    val blankLines = sc.accumulator(0)
    ```
  - 累加器的用法：
    - 通过在驱动器中调用 SparkContext.accumulator(initialValue) 方法，创建出存有初始值的累加器。返回值为 org.apache.spark.Accumulator[T] 对象，其中 T 是初始值
initialValue 的类型。
    - Spark 闭包里的执行器代码可以使用累加器的 += 方法（在 Java 中是 add）增加累加器的值。
    - 驱动器程序可以调用累加器的 value 属性（在 Java 中使用 value() 或 setValue()）来访问累加器的值。
  - 注意细节：
    - 工作节点上的任务不能访问累加器的值。从这些任务的角度来看，累加器是一个只写变量。
  - 累加器与容错性：
    - Spark会自动重新执行失败的或较慢的任务来应对有错误的或者比较慢的机器。
    - 对于要在行动操作中使用的累加器，Spark只会把每个任务对各累加器的修改应用一次。因此，如果想要一个无论在失败还是重复计算时都绝对可靠的累加器，我们必须把它放在 foreach() 这样的行动操作中。
    - 对于在 RDD 转化操作中使用的累加器，就不能保证有这种情况了。转化操作中累加器可能会发生不止一次更新。在转化操作中，累加器通常只用于调试目的。
    
## 广播变量

